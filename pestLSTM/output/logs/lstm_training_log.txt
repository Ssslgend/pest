2025-05-01 15:48:38,647 - INFO - Using device: cuda
2025-05-01 15:48:38,648 - INFO - Random seed set to: 42
2025-05-01 15:48:38,648 - INFO - --- Starting LSTM Model Training ---
2025-05-01 15:48:38,648 - INFO - Attempting to load data from resolved path: e:\code\0424\pestBIstm\pestBIstm\datas\sd_all_1.csv
2025-05-01 15:48:38,648 - INFO - Loading data from: e:\code\0424\pestBIstm\pestBIstm\datas\sd_all_1.csv
2025-05-01 15:48:38,651 - ERROR - Error loading or processing data from e:\code\0424\pestBIstm\pestBIstm\datas\sd_all_1.csv: 'utf-8' codec can't decode byte 0xb5 in position 15: invalid start byte
Traceback (most recent call last):
  File "e:\code\0424\pestBIstm\pestBIstm\pestLSTM\train_lstm.py", line 63, in load_data_from_csv
    df = pd.read_csv(csv_path)
  File "D:\anaconda\envs\pytorch-gpu\lib\site-packages\pandas\io\parsers\readers.py", line 912, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "D:\anaconda\envs\pytorch-gpu\lib\site-packages\pandas\io\parsers\readers.py", line 577, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "D:\anaconda\envs\pytorch-gpu\lib\site-packages\pandas\io\parsers\readers.py", line 1407, in __init__
    self._engine = self._make_engine(f, self.engine)
  File "D:\anaconda\envs\pytorch-gpu\lib\site-packages\pandas\io\parsers\readers.py", line 1679, in _make_engine
    return mapping[engine](f, **self.options)
  File "D:\anaconda\envs\pytorch-gpu\lib\site-packages\pandas\io\parsers\c_parser_wrapper.py", line 93, in __init__
    self._reader = parsers.TextReader(src, **kwds)
  File "pandas\_libs\parsers.pyx", line 550, in pandas._libs.parsers.TextReader.__cinit__
  File "pandas\_libs\parsers.pyx", line 639, in pandas._libs.parsers.TextReader._get_header
  File "pandas\_libs\parsers.pyx", line 850, in pandas._libs.parsers.TextReader._tokenize_rows
  File "pandas\_libs\parsers.pyx", line 861, in pandas._libs.parsers.TextReader._check_tokenize_status
  File "pandas\_libs\parsers.pyx", line 2021, in pandas._libs.parsers.raise_parser_error
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb5 in position 15: invalid start byte
2025-05-01 15:48:38,654 - ERROR - Exiting due to data loading error: 'utf-8' codec can't decode byte 0xb5 in position 15: invalid start byte
Traceback (most recent call last):
  File "e:\code\0424\pestBIstm\pestBIstm\pestLSTM\train_lstm.py", line 134, in train_model
    X_data_raw, y_data, coords_data, feature_names_loaded = load_data_from_csv(csv_path)
  File "e:\code\0424\pestBIstm\pestBIstm\pestLSTM\train_lstm.py", line 63, in load_data_from_csv
    df = pd.read_csv(csv_path)
  File "D:\anaconda\envs\pytorch-gpu\lib\site-packages\pandas\io\parsers\readers.py", line 912, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "D:\anaconda\envs\pytorch-gpu\lib\site-packages\pandas\io\parsers\readers.py", line 577, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "D:\anaconda\envs\pytorch-gpu\lib\site-packages\pandas\io\parsers\readers.py", line 1407, in __init__
    self._engine = self._make_engine(f, self.engine)
  File "D:\anaconda\envs\pytorch-gpu\lib\site-packages\pandas\io\parsers\readers.py", line 1679, in _make_engine
    return mapping[engine](f, **self.options)
  File "D:\anaconda\envs\pytorch-gpu\lib\site-packages\pandas\io\parsers\c_parser_wrapper.py", line 93, in __init__
    self._reader = parsers.TextReader(src, **kwds)
  File "pandas\_libs\parsers.pyx", line 550, in pandas._libs.parsers.TextReader.__cinit__
  File "pandas\_libs\parsers.pyx", line 639, in pandas._libs.parsers.TextReader._get_header
  File "pandas\_libs\parsers.pyx", line 850, in pandas._libs.parsers.TextReader._tokenize_rows
  File "pandas\_libs\parsers.pyx", line 861, in pandas._libs.parsers.TextReader._check_tokenize_status
  File "pandas\_libs\parsers.pyx", line 2021, in pandas._libs.parsers.raise_parser_error
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb5 in position 15: invalid start byte
2025-05-01 15:54:37,130 - INFO - Using device: cuda
2025-05-01 15:54:37,131 - INFO - Random seed set to: 42
2025-05-01 15:54:37,131 - INFO - --- Starting LSTM Model Training ---
2025-05-01 15:54:37,131 - INFO - Attempting to load data from resolved path: e:\code\0424\pestBIstm\pestBIstm\datas\sd_all_1.csv
2025-05-01 15:54:37,131 - INFO - Loading data from: e:\code\0424\pestBIstm\pestBIstm\datas\sd_all_1.csv
2025-05-01 15:54:37,137 - INFO - Data loaded successfully with shape: (123, 27)
2025-05-01 15:54:37,137 - INFO - Columns: ['sd_station', 'X', 'Y', '等温性', '降水季节性', '年降水量', '年均温_', '平均日较差', '温度季节性', '温度年较差', '最干季度降水量', '最干季度平均温度', '最干月降水量', '最冷季度降水量', '最冷季度平均温度', '最冷月最低温', '最热季度降水量', '最热季度平均温度', '最热月最高温', '最湿季度降水量', '最湿季度平均温度', 'evi_Band_1', 'lai_Band_1', 'lst_Band_1', 'ndvi_Band_', 'pet_Band_1', 'BYQ_baie']
2025-05-01 15:54:37,138 - INFO - Target column: BYQ_baie
2025-05-01 15:54:37,138 - INFO - Coordinate columns: ['X', 'Y']
2025-05-01 15:54:37,138 - INFO - Identified feature columns (23): ['等温性', '降水季节性', '年降水量', '年均温_', '平均日较差', '温度季节性', '温度年较差', '最干季度降水量', '最干季度平均温度', '最干月降水量', '最冷季度降水量', '最冷季度平均温度', '最冷月最低温', '最热季度降水量', '最热季度平均温度', '最热月最高温', '最湿季度降水量', '最湿季度平均温度', 'evi_Band_1', 'lai_Band_1', 'lst_Band_1', 'ndvi_Band_', 'pet_Band_1']
2025-05-01 15:54:37,140 - INFO - No NaN values found in features.
2025-05-01 15:54:37,140 - INFO - Unique values in target column 'BYQ_baie': [1.]
2025-05-01 15:54:37,141 - WARNING - Target column 'BYQ_baie' contains only one class value. Training/Evaluation might be problematic.
2025-05-01 15:54:37,141 - INFO - Data shapes - X: (123, 23), y: (123,), Coords: (123, 2)
2025-05-01 15:54:37,141 - WARNING - Feature names loaded from CSV differ from those in config_lstm.py. Using features from CSV.
2025-05-01 15:54:37,142 - INFO - Features scaled using StandardScaler.
2025-05-01 15:54:37,144 - INFO - Scaler saved to e:\code\0424\pestBIstm\pestBIstm\pestLSTM\output\scalers\lstm_scaler.joblib
2025-05-01 15:54:37,144 - INFO - Data reshaped for LSTM: X shape (123, 1, 23), y shape (123, 1)
2025-05-01 15:54:37,154 - INFO - Total dataset size: 123
2025-05-01 15:54:37,160 - INFO - Training set size: 111
2025-05-01 15:54:37,160 - INFO - Validation set size: 12
2025-05-01 15:54:37,378 - INFO - LSTM Model initialized with input_size=23:
LSTMModel(
  (lstm): LSTM(23, 64, batch_first=True)
  (norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (fc1): Linear(in_features=64, out_features=32, bias=True)
  (fc1_activation): ReLU()
  (fc1_dropout): Dropout(p=0.1, inplace=False)
  (fc2): Linear(in_features=32, out_features=1, bias=True)
  (output_activation): Sigmoid()
)
2025-05-01 15:54:37,379 - INFO - Total parameters: 25025
2025-05-01 15:54:37,379 - INFO - Using loss function: BCELoss
2025-05-01 15:54:38,212 - INFO - Using optimizer: Adam with LR: 0.001
2025-05-01 15:54:38,212 - INFO - Using StepLR scheduler: step_size=10, gamma=0.5
2025-05-01 15:54:38,213 - INFO - --- Starting Training Loop ---
2025-05-01 15:54:38,489 - WARNING - Epoch 1: Only one class ([1.]) present in training batch labels, train AUC set to 0.5.
2025-05-01 15:54:38,498 - INFO - Epoch 1/50 - Duration: 0.29s - Train Loss: 0.3157, Train AUC: 0.5000 - Val Loss: 0.3034, Val AUC: 0.5000
2025-05-01 15:54:38,498 - INFO - Validation AUC improved (-inf --> 0.5000).
2025-05-01 15:54:38,498 - INFO - Saving best model to e:\code\0424\pestBIstm\pestBIstm\pestLSTM\output\checkpoints\lstm_model_best.pth
2025-05-01 15:54:38,510 - WARNING - Epoch 2: Only one class ([1.]) present in training batch labels, train AUC set to 0.5.
2025-05-01 15:54:38,513 - INFO - Epoch 2/50 - Duration: 0.01s - Train Loss: 0.2505, Train AUC: 0.5000 - Val Loss: 0.2487, Val AUC: 0.5000
2025-05-01 15:54:38,513 - INFO - Validation AUC did not improve for 1 epochs.
2025-05-01 15:54:38,517 - WARNING - Epoch 3: Only one class ([1.]) present in training batch labels, train AUC set to 0.5.
2025-05-01 15:54:38,520 - INFO - Epoch 3/50 - Duration: 0.01s - Train Loss: 0.1937, Train AUC: 0.5000 - Val Loss: 0.2027, Val AUC: 0.5000
2025-05-01 15:54:38,521 - INFO - Validation AUC did not improve for 2 epochs.
2025-05-01 15:54:38,524 - WARNING - Epoch 4: Only one class ([1.]) present in training batch labels, train AUC set to 0.5.
2025-05-01 15:54:38,527 - INFO - Epoch 4/50 - Duration: 0.01s - Train Loss: 0.1572, Train AUC: 0.5000 - Val Loss: 0.1625, Val AUC: 0.5000
2025-05-01 15:54:38,527 - INFO - Validation AUC did not improve for 3 epochs.
2025-05-01 15:54:38,531 - WARNING - Epoch 5: Only one class ([1.]) present in training batch labels, train AUC set to 0.5.
2025-05-01 15:54:38,533 - INFO - Epoch 5/50 - Duration: 0.01s - Train Loss: 0.1289, Train AUC: 0.5000 - Val Loss: 0.1294, Val AUC: 0.5000
2025-05-01 15:54:38,534 - INFO - Validation AUC did not improve for 4 epochs.
2025-05-01 15:54:38,537 - WARNING - Epoch 6: Only one class ([1.]) present in training batch labels, train AUC set to 0.5.
2025-05-01 15:54:38,540 - INFO - Epoch 6/50 - Duration: 0.01s - Train Loss: 0.0969, Train AUC: 0.5000 - Val Loss: 0.1017, Val AUC: 0.5000
2025-05-01 15:54:38,540 - INFO - Validation AUC did not improve for 5 epochs.
2025-05-01 15:54:38,544 - WARNING - Epoch 7: Only one class ([1.]) present in training batch labels, train AUC set to 0.5.
2025-05-01 15:54:38,547 - INFO - Epoch 7/50 - Duration: 0.01s - Train Loss: 0.0821, Train AUC: 0.5000 - Val Loss: 0.0800, Val AUC: 0.5000
2025-05-01 15:54:38,547 - INFO - Validation AUC did not improve for 6 epochs.
2025-05-01 15:54:38,551 - WARNING - Epoch 8: Only one class ([1.]) present in training batch labels, train AUC set to 0.5.
2025-05-01 15:54:38,554 - INFO - Epoch 8/50 - Duration: 0.01s - Train Loss: 0.0705, Train AUC: 0.5000 - Val Loss: 0.0634, Val AUC: 0.5000
2025-05-01 15:54:38,554 - INFO - Validation AUC did not improve for 7 epochs.
2025-05-01 15:54:38,558 - WARNING - Epoch 9: Only one class ([1.]) present in training batch labels, train AUC set to 0.5.
2025-05-01 15:54:38,561 - INFO - Epoch 9/50 - Duration: 0.01s - Train Loss: 0.0541, Train AUC: 0.5000 - Val Loss: 0.0506, Val AUC: 0.5000
2025-05-01 15:54:38,561 - INFO - Validation AUC did not improve for 8 epochs.
2025-05-01 15:54:38,566 - WARNING - Epoch 10: Only one class ([1.]) present in training batch labels, train AUC set to 0.5.
2025-05-01 15:54:38,570 - INFO - Epoch 10/50 - Duration: 0.01s - Train Loss: 0.0489, Train AUC: 0.5000 - Val Loss: 0.0408, Val AUC: 0.5000
2025-05-01 15:54:38,570 - INFO - Validation AUC did not improve for 9 epochs.
2025-05-01 15:54:38,573 - WARNING - Epoch 11: Only one class ([1.]) present in training batch labels, train AUC set to 0.5.
2025-05-01 15:54:38,577 - INFO - Epoch 11/50 - Duration: 0.01s - Train Loss: 0.0354, Train AUC: 0.5000 - Val Loss: 0.0369, Val AUC: 0.5000
2025-05-01 15:54:38,577 - INFO - Validation AUC did not improve for 10 epochs.
2025-05-01 15:54:38,577 - INFO - Early stopping triggered after 11 epochs.
2025-05-01 15:54:38,577 - INFO - --- Training Finished --- Total Time: 1.45s
2025-05-01 15:54:38,960 - INFO - --- Evaluating Best Model on Validation Set ---
2025-05-01 15:54:38,969 - INFO - Loaded best model from epoch 1 with Val AUC 0.5000
2025-05-01 15:54:38,974 - INFO - Best Model Validation Set Metrics:
2025-05-01 15:54:38,974 - INFO -   loss: 0.3034
2025-05-01 15:54:38,974 - INFO -   auc: 0.5000
2025-05-01 15:54:38,974 - INFO -   accuracy: 0.9167
2025-05-01 15:54:38,974 - INFO -   precision: 1.0000
2025-05-01 15:54:38,974 - INFO -   recall: 0.9167
2025-05-01 15:54:38,975 - INFO -   f1: 0.9565
2025-05-01 15:54:38,975 - INFO -   confusion_matrix: 
[[ 0  0]
 [ 1 11]]
2025-05-01 16:06:40,544 - INFO - Using device: cuda
2025-05-01 16:06:40,544 - INFO - Random seed set to: 42
2025-05-01 16:06:40,545 - INFO - --- Starting LSTM Model Training ---
2025-05-01 16:06:40,545 - INFO - Attempting to load data from resolved path: e:\code\0424\pestBIstm\pestBIstm\datas\sd_all_2.csv
2025-05-01 16:06:40,545 - INFO - Loading data from: e:\code\0424\pestBIstm\pestBIstm\datas\sd_all_2.csv
2025-05-01 16:06:40,548 - ERROR - Error loading or processing data from e:\code\0424\pestBIstm\pestBIstm\datas\sd_all_2.csv: 'gbk' codec can't decode byte 0xa7 in position 26: illegal multibyte sequence
Traceback (most recent call last):
  File "e:\code\0424\pestBIstm\pestBIstm\pestLSTM\train_lstm.py", line 64, in load_data_from_csv
    df = pd.read_csv(csv_path, encoding='gbk')
  File "D:\anaconda\envs\pytorch-gpu\lib\site-packages\pandas\io\parsers\readers.py", line 912, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "D:\anaconda\envs\pytorch-gpu\lib\site-packages\pandas\io\parsers\readers.py", line 577, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "D:\anaconda\envs\pytorch-gpu\lib\site-packages\pandas\io\parsers\readers.py", line 1407, in __init__
    self._engine = self._make_engine(f, self.engine)
  File "D:\anaconda\envs\pytorch-gpu\lib\site-packages\pandas\io\parsers\readers.py", line 1679, in _make_engine
    return mapping[engine](f, **self.options)
  File "D:\anaconda\envs\pytorch-gpu\lib\site-packages\pandas\io\parsers\c_parser_wrapper.py", line 93, in __init__
    self._reader = parsers.TextReader(src, **kwds)
  File "pandas\_libs\parsers.pyx", line 550, in pandas._libs.parsers.TextReader.__cinit__
  File "pandas\_libs\parsers.pyx", line 639, in pandas._libs.parsers.TextReader._get_header
  File "pandas\_libs\parsers.pyx", line 850, in pandas._libs.parsers.TextReader._tokenize_rows
  File "pandas\_libs\parsers.pyx", line 861, in pandas._libs.parsers.TextReader._check_tokenize_status
  File "pandas\_libs\parsers.pyx", line 2021, in pandas._libs.parsers.raise_parser_error
UnicodeDecodeError: 'gbk' codec can't decode byte 0xa7 in position 26: illegal multibyte sequence
2025-05-01 16:06:40,551 - ERROR - Exiting due to data loading error: 'gbk' codec can't decode byte 0xa7 in position 26: illegal multibyte sequence
Traceback (most recent call last):
  File "e:\code\0424\pestBIstm\pestBIstm\pestLSTM\train_lstm.py", line 135, in train_model
    X_data_raw, y_data, coords_data, feature_names_loaded = load_data_from_csv(csv_path)
  File "e:\code\0424\pestBIstm\pestBIstm\pestLSTM\train_lstm.py", line 64, in load_data_from_csv
    df = pd.read_csv(csv_path, encoding='gbk')
  File "D:\anaconda\envs\pytorch-gpu\lib\site-packages\pandas\io\parsers\readers.py", line 912, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "D:\anaconda\envs\pytorch-gpu\lib\site-packages\pandas\io\parsers\readers.py", line 577, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "D:\anaconda\envs\pytorch-gpu\lib\site-packages\pandas\io\parsers\readers.py", line 1407, in __init__
    self._engine = self._make_engine(f, self.engine)
  File "D:\anaconda\envs\pytorch-gpu\lib\site-packages\pandas\io\parsers\readers.py", line 1679, in _make_engine
    return mapping[engine](f, **self.options)
  File "D:\anaconda\envs\pytorch-gpu\lib\site-packages\pandas\io\parsers\c_parser_wrapper.py", line 93, in __init__
    self._reader = parsers.TextReader(src, **kwds)
  File "pandas\_libs\parsers.pyx", line 550, in pandas._libs.parsers.TextReader.__cinit__
  File "pandas\_libs\parsers.pyx", line 639, in pandas._libs.parsers.TextReader._get_header
  File "pandas\_libs\parsers.pyx", line 850, in pandas._libs.parsers.TextReader._tokenize_rows
  File "pandas\_libs\parsers.pyx", line 861, in pandas._libs.parsers.TextReader._check_tokenize_status
  File "pandas\_libs\parsers.pyx", line 2021, in pandas._libs.parsers.raise_parser_error
UnicodeDecodeError: 'gbk' codec can't decode byte 0xa7 in position 26: illegal multibyte sequence
2025-05-01 16:10:16,272 - INFO - Using device: cuda
2025-05-01 16:10:16,273 - INFO - Random seed set to: 42
2025-05-01 16:10:16,273 - INFO - --- Starting LSTM Model Training ---
2025-05-01 16:10:16,273 - INFO - Attempting to load data from resolved path: e:\code\0424\pestBIstm\pestBIstm\datas\sd_all_2.csv
2025-05-01 16:10:16,273 - INFO - Loading data from: e:\code\0424\pestBIstm\pestBIstm\datas\sd_all_2.csv
2025-05-01 16:10:16,275 - INFO - Data loaded successfully with shape: (123, 30)
2025-05-01 16:10:16,275 - INFO - Columns: ['sd_station', 'X', 'Y', '等温性', '降水季节性', '年降水量', '年均温_', '平均日较差', '温度季节性', '温度年较差', '最干季度降水量', '最干季度平均温度', '最干月降水量', '最冷季度降水量', '最冷季度平均温度', '最冷月最低温', '最热季度降水量', '最热季度平均温度', '最热月最高温', '最湿季度降水量', '最湿季度平均温度', 'Unnamed: 21', 'Unnamed: 22', 'Unnamed: 23', 'evi_Band_1', 'lai_Band_1', 'lst_Band_1', 'ndvi_Band_', 'pet_Band_1', 'BYQ_baie']
2025-05-01 16:10:16,276 - INFO - Target column: BYQ_baie
2025-05-01 16:10:16,276 - INFO - Coordinate columns: ['X', 'Y']
2025-05-01 16:10:16,276 - INFO - Identified feature columns (26): ['等温性', '降水季节性', '年降水量', '年均温_', '平均日较差', '温度季节性', '温度年较差', '最干季度降水量', '最干季度平均温度', '最干月降水量', '最冷季度降水量', '最冷季度平均温度', '最冷月最低温', '最热季度降水量', '最热季度平均温度', '最热月最高温', '最湿季度降水量', '最湿季度平均温度', 'Unnamed: 21', 'Unnamed: 22', 'Unnamed: 23', 'evi_Band_1', 'lai_Band_1', 'lst_Band_1', 'ndvi_Band_', 'pet_Band_1']
2025-05-01 16:10:16,278 - WARNING - Found 369 NaN values in features. Imputing with mean.
2025-05-01 16:10:16,280 - INFO - Unique values in target column 'BYQ_baie': [0. 1.]
2025-05-01 16:10:16,280 - INFO - Data shapes - X: (123, 23), y: (123,), Coords: (123, 2)
2025-05-01 16:10:16,280 - WARNING - Feature names loaded from CSV differ from those in config_lstm.py. Using features from CSV.
2025-05-01 16:10:16,281 - INFO - Features scaled using StandardScaler.
2025-05-01 16:10:16,282 - INFO - Scaler saved to e:\code\0424\pestBIstm\pestBIstm\pestLSTM\output\scalers\lstm_scaler.joblib
2025-05-01 16:10:16,282 - INFO - Data reshaped for LSTM: X shape (123, 1, 23), y shape (123, 1)
2025-05-01 16:10:16,283 - INFO - Total dataset size: 123
2025-05-01 16:10:16,283 - INFO - Training set size: 111
2025-05-01 16:10:16,283 - INFO - Validation set size: 12
2025-05-01 16:10:16,414 - INFO - LSTM Model initialized with input_size=23:
LSTMModel(
  (lstm): LSTM(23, 64, batch_first=True)
  (norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (fc1): Linear(in_features=64, out_features=32, bias=True)
  (fc1_activation): ReLU()
  (fc1_dropout): Dropout(p=0.1, inplace=False)
  (fc2): Linear(in_features=32, out_features=1, bias=True)
  (output_activation): Sigmoid()
)
2025-05-01 16:10:16,415 - INFO - Total parameters: 25025
2025-05-01 16:10:16,415 - INFO - Using loss function: BCELoss
2025-05-01 16:10:17,013 - INFO - Using optimizer: Adam with LR: 0.001
2025-05-01 16:10:17,014 - INFO - Using StepLR scheduler: step_size=10, gamma=0.5
2025-05-01 16:10:17,014 - INFO - --- Starting Training Loop ---
2025-05-01 16:14:09,180 - INFO - Using device: cuda
2025-05-01 16:14:09,180 - INFO - Random seed set to: 42
2025-05-01 16:14:09,181 - INFO - --- Starting LSTM Model Training ---
2025-05-01 16:14:09,181 - INFO - Attempting to load data from resolved path: e:\code\0424\pestBIstm\pestBIstm\datas\sd_all_2.csv
2025-05-01 16:14:09,182 - INFO - Loading data from: e:\code\0424\pestBIstm\pestBIstm\datas\sd_all_2.csv
2025-05-01 16:14:09,184 - INFO - Data loaded successfully with shape: (123, 30)
2025-05-01 16:14:09,184 - INFO - Columns: ['sd_station', 'X', 'Y', '等温性', '降水季节性', '年降水量', '年均温_', '平均日较差', '温度季节性', '温度年较差', '最干季度降水量', '最干季度平均温度', '最干月降水量', '最冷季度降水量', '最冷季度平均温度', '最冷月最低温', '最热季度降水量', '最热季度平均温度', '最热月最高温', '最湿季度降水量', '最湿季度平均温度', 'Unnamed: 21', 'Unnamed: 22', 'Unnamed: 23', 'evi_Band_1', 'lai_Band_1', 'lst_Band_1', 'ndvi_Band_', 'pet_Band_1', 'BYQ_baie']
2025-05-01 16:14:09,185 - INFO - Target column: BYQ_baie
2025-05-01 16:14:09,185 - INFO - Coordinate columns: ['X', 'Y']
2025-05-01 16:14:09,185 - INFO - Identified feature columns (26): ['等温性', '降水季节性', '年降水量', '年均温_', '平均日较差', '温度季节性', '温度年较差', '最干季度降水量', '最干季度平均温度', '最干月降水量', '最冷季度降水量', '最冷季度平均温度', '最冷月最低温', '最热季度降水量', '最热季度平均温度', '最热月最高温', '最湿季度降水量', '最湿季度平均温度', 'Unnamed: 21', 'Unnamed: 22', 'Unnamed: 23', 'evi_Band_1', 'lai_Band_1', 'lst_Band_1', 'ndvi_Band_', 'pet_Band_1']
2025-05-01 16:14:09,186 - WARNING - Found 369 NaN values in features. Imputing with mean.
2025-05-01 16:14:09,188 - INFO - Unique values in target column 'BYQ_baie': [0. 1.]
2025-05-01 16:14:09,188 - INFO - Data shapes - X: (123, 23), y: (123,), Coords: (123, 2)
2025-05-01 16:14:09,188 - WARNING - Feature names loaded from CSV differ from those in config_lstm.py. Using features from CSV.
2025-05-01 16:14:09,189 - INFO - Features scaled using StandardScaler.
2025-05-01 16:14:09,191 - INFO - Scaler saved to e:\code\0424\pestBIstm\pestBIstm\pestLSTM\output\scalers\lstm_scaler.joblib
2025-05-01 16:14:09,191 - INFO - Data reshaped for LSTM: X shape (123, 1, 23), y shape (123, 1)
2025-05-01 16:14:09,192 - INFO - Total dataset size: 123
2025-05-01 16:14:09,192 - INFO - Training set size: 111
2025-05-01 16:14:09,192 - INFO - Validation set size: 12
2025-05-01 16:14:09,310 - INFO - LSTM Model initialized with input_size=23:
LSTMModel(
  (lstm): LSTM(23, 64, batch_first=True)
  (norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (fc1): Linear(in_features=64, out_features=32, bias=True)
  (fc1_activation): ReLU()
  (fc1_dropout): Dropout(p=0.1, inplace=False)
  (fc2): Linear(in_features=32, out_features=1, bias=True)
  (output_activation): Sigmoid()
)
2025-05-01 16:14:09,311 - INFO - Total parameters: 25025
2025-05-01 16:14:09,311 - INFO - Using loss function: BCELoss
2025-05-01 16:14:09,912 - INFO - Using optimizer: Adam with LR: 0.001
2025-05-01 16:14:09,912 - INFO - Using StepLR scheduler: step_size=10, gamma=0.5
2025-05-01 16:14:09,912 - INFO - --- Starting Training Loop ---
2025-05-01 16:14:10,014 - INFO - Epoch 1/50 - Duration: 0.10s - Train Loss: 1.3285, Train AUC: 0.3736 - Val Loss: 1.1811, Val AUC: 0.3125
2025-05-01 16:14:10,015 - INFO - Validation AUC improved (-inf --> 0.3125).
2025-05-01 16:14:10,015 - INFO - Saving best model to e:\code\0424\pestBIstm\pestBIstm\pestLSTM\output\checkpoints\lstm_model_best.pth
2025-05-01 16:14:10,025 - INFO - Epoch 2/50 - Duration: 0.01s - Train Loss: 1.1596, Train AUC: 0.4518 - Val Loss: 1.0300, Val AUC: 0.4375
2025-05-01 16:14:10,025 - INFO - Validation AUC improved (0.3125 --> 0.4375).
2025-05-01 16:14:10,026 - INFO - Saving best model to e:\code\0424\pestBIstm\pestBIstm\pestLSTM\output\checkpoints\lstm_model_best.pth
2025-05-01 16:14:10,038 - INFO - Epoch 3/50 - Duration: 0.01s - Train Loss: 0.9994, Train AUC: 0.5614 - Val Loss: 0.9058, Val AUC: 0.5625
2025-05-01 16:14:10,038 - INFO - Validation AUC improved (0.4375 --> 0.5625).
2025-05-01 16:14:10,038 - INFO - Saving best model to e:\code\0424\pestBIstm\pestBIstm\pestLSTM\output\checkpoints\lstm_model_best.pth
2025-05-01 16:14:10,053 - INFO - Epoch 4/50 - Duration: 0.01s - Train Loss: 0.8803, Train AUC: 0.5990 - Val Loss: 0.8059, Val AUC: 0.6250
2025-05-01 16:14:10,053 - INFO - Validation AUC improved (0.5625 --> 0.6250).
2025-05-01 16:14:10,053 - INFO - Saving best model to e:\code\0424\pestBIstm\pestBIstm\pestLSTM\output\checkpoints\lstm_model_best.pth
2025-05-01 16:14:10,066 - INFO - Epoch 5/50 - Duration: 0.01s - Train Loss: 0.7724, Train AUC: 0.6746 - Val Loss: 0.7304, Val AUC: 0.6250
2025-05-01 16:14:10,067 - INFO - Validation AUC did not improve for 1 epochs.
2025-05-01 16:14:10,075 - INFO - Epoch 6/50 - Duration: 0.01s - Train Loss: 0.7444, Train AUC: 0.6658 - Val Loss: 0.6742, Val AUC: 0.6250
2025-05-01 16:14:10,075 - INFO - Validation AUC did not improve for 2 epochs.
2025-05-01 16:14:10,085 - INFO - Epoch 7/50 - Duration: 0.01s - Train Loss: 0.6536, Train AUC: 0.7118 - Val Loss: 0.6324, Val AUC: 0.6562
2025-05-01 16:14:10,085 - INFO - Validation AUC improved (0.6250 --> 0.6562).
2025-05-01 16:14:10,086 - INFO - Saving best model to e:\code\0424\pestBIstm\pestBIstm\pestLSTM\output\checkpoints\lstm_model_best.pth
2025-05-01 16:14:10,095 - INFO - Epoch 8/50 - Duration: 0.01s - Train Loss: 0.6225, Train AUC: 0.7188 - Val Loss: 0.5995, Val AUC: 0.7188
2025-05-01 16:14:10,096 - INFO - Validation AUC improved (0.6562 --> 0.7188).
2025-05-01 16:14:10,096 - INFO - Saving best model to e:\code\0424\pestBIstm\pestBIstm\pestLSTM\output\checkpoints\lstm_model_best.pth
2025-05-01 16:14:10,107 - INFO - Epoch 9/50 - Duration: 0.01s - Train Loss: 0.5916, Train AUC: 0.7341 - Val Loss: 0.5714, Val AUC: 0.7500
2025-05-01 16:14:10,107 - INFO - Validation AUC improved (0.7188 --> 0.7500).
2025-05-01 16:14:10,107 - INFO - Saving best model to e:\code\0424\pestBIstm\pestBIstm\pestLSTM\output\checkpoints\lstm_model_best.pth
2025-05-01 16:14:10,117 - INFO - Epoch 10/50 - Duration: 0.01s - Train Loss: 0.5430, Train AUC: 0.7860 - Val Loss: 0.5473, Val AUC: 0.8125
2025-05-01 16:14:10,118 - INFO - Validation AUC improved (0.7500 --> 0.8125).
2025-05-01 16:14:10,118 - INFO - Saving best model to e:\code\0424\pestBIstm\pestBIstm\pestLSTM\output\checkpoints\lstm_model_best.pth
2025-05-01 16:14:10,129 - INFO - Epoch 11/50 - Duration: 0.01s - Train Loss: 0.5350, Train AUC: 0.7845 - Val Loss: 0.5364, Val AUC: 0.8438
2025-05-01 16:14:10,129 - INFO - Validation AUC improved (0.8125 --> 0.8438).
2025-05-01 16:14:10,130 - INFO - Saving best model to e:\code\0424\pestBIstm\pestBIstm\pestLSTM\output\checkpoints\lstm_model_best.pth
2025-05-01 16:14:10,141 - INFO - Epoch 12/50 - Duration: 0.01s - Train Loss: 0.5062, Train AUC: 0.8068 - Val Loss: 0.5262, Val AUC: 0.8438
2025-05-01 16:14:10,141 - INFO - Validation AUC did not improve for 1 epochs.
2025-05-01 16:14:10,149 - INFO - Epoch 13/50 - Duration: 0.01s - Train Loss: 0.4948, Train AUC: 0.8240 - Val Loss: 0.5174, Val AUC: 0.8438
2025-05-01 16:14:10,149 - INFO - Validation AUC did not improve for 2 epochs.
2025-05-01 16:14:10,155 - INFO - Epoch 14/50 - Duration: 0.01s - Train Loss: 0.4980, Train AUC: 0.8115 - Val Loss: 0.5097, Val AUC: 0.8750
2025-05-01 16:14:10,156 - INFO - Validation AUC improved (0.8438 --> 0.8750).
2025-05-01 16:14:10,156 - INFO - Saving best model to e:\code\0424\pestBIstm\pestBIstm\pestLSTM\output\checkpoints\lstm_model_best.pth
2025-05-01 16:14:10,167 - INFO - Epoch 15/50 - Duration: 0.01s - Train Loss: 0.4952, Train AUC: 0.8170 - Val Loss: 0.5030, Val AUC: 0.8750
2025-05-01 16:14:10,168 - INFO - Validation AUC did not improve for 1 epochs.
2025-05-01 16:14:10,174 - INFO - Epoch 16/50 - Duration: 0.01s - Train Loss: 0.5408, Train AUC: 0.7699 - Val Loss: 0.4970, Val AUC: 0.8750
2025-05-01 16:14:10,175 - INFO - Validation AUC did not improve for 2 epochs.
2025-05-01 16:14:10,181 - INFO - Epoch 17/50 - Duration: 0.01s - Train Loss: 0.4727, Train AUC: 0.8386 - Val Loss: 0.4917, Val AUC: 0.8750
2025-05-01 16:14:10,182 - INFO - Validation AUC did not improve for 3 epochs.
2025-05-01 16:14:10,188 - INFO - Epoch 18/50 - Duration: 0.01s - Train Loss: 0.4702, Train AUC: 0.8320 - Val Loss: 0.4871, Val AUC: 0.8750
2025-05-01 16:14:10,188 - INFO - Validation AUC did not improve for 4 epochs.
2025-05-01 16:14:10,196 - INFO - Epoch 19/50 - Duration: 0.01s - Train Loss: 0.4695, Train AUC: 0.8444 - Val Loss: 0.4830, Val AUC: 0.8125
2025-05-01 16:14:10,196 - INFO - Validation AUC did not improve for 5 epochs.
2025-05-01 16:14:10,203 - INFO - Epoch 20/50 - Duration: 0.01s - Train Loss: 0.4540, Train AUC: 0.8517 - Val Loss: 0.4795, Val AUC: 0.8125
2025-05-01 16:14:10,203 - INFO - Validation AUC did not improve for 6 epochs.
2025-05-01 16:14:10,210 - INFO - Epoch 21/50 - Duration: 0.01s - Train Loss: 0.4660, Train AUC: 0.8364 - Val Loss: 0.4779, Val AUC: 0.8125
2025-05-01 16:14:10,211 - INFO - Validation AUC did not improve for 7 epochs.
2025-05-01 16:14:10,218 - INFO - Epoch 22/50 - Duration: 0.01s - Train Loss: 0.4677, Train AUC: 0.8393 - Val Loss: 0.4766, Val AUC: 0.8125
2025-05-01 16:14:10,218 - INFO - Validation AUC did not improve for 8 epochs.
2025-05-01 16:14:10,225 - INFO - Epoch 23/50 - Duration: 0.01s - Train Loss: 0.4294, Train AUC: 0.8729 - Val Loss: 0.4755, Val AUC: 0.8438
2025-05-01 16:14:10,225 - INFO - Validation AUC did not improve for 9 epochs.
2025-05-01 16:14:10,232 - INFO - Epoch 24/50 - Duration: 0.01s - Train Loss: 0.4496, Train AUC: 0.8532 - Val Loss: 0.4747, Val AUC: 0.8438
2025-05-01 16:14:10,232 - INFO - Validation AUC did not improve for 10 epochs.
2025-05-01 16:14:10,232 - INFO - Early stopping triggered after 24 epochs.
2025-05-01 16:14:10,233 - INFO - --- Training Finished --- Total Time: 1.05s
2025-05-01 16:14:10,515 - INFO - --- Evaluating Best Model on Validation Set ---
2025-05-01 16:14:10,525 - INFO - Loaded best model from epoch 14 with Val AUC 0.8750
2025-05-01 16:14:10,530 - INFO - Best Model Validation Set Metrics:
2025-05-01 16:14:10,530 - INFO -   loss: 0.5097
2025-05-01 16:14:10,530 - INFO -   auc: 0.8750
2025-05-01 16:14:10,530 - INFO -   accuracy: 0.7500
2025-05-01 16:14:10,530 - INFO -   precision: 0.6000
2025-05-01 16:14:10,530 - INFO -   recall: 0.7500
2025-05-01 16:14:10,531 - INFO -   f1: 0.6667
2025-05-01 16:14:10,531 - INFO -   confusion_matrix: 
[[6 2]
 [1 3]]
