# 山东省美国白蛾数据文件整理说明

## 📁 源文件（原始数据）

### 1. 发病数据
- **`./datas/shandong_pest_data/发病情况.xlsx`** ⭐ **重要源文件**
  - 内容：山东省各县美国白蛾真实发病程度数据
  - 时间范围：2019-2024年
  - 包含字段：Year, City, County,
    - 一龄幼虫发生程度（5-6月，卵2，幼虫1，蛹0，无）
    - 发生程度7-8月
    - 发生程度9-10月（越接近蛹期越关键）
  - 程度说明：1-3表示发生严重程度，不是是否发生（所有县都有发生）

- **`./shandong_american_moth_occurrences.xlsx`**
  - 内容：美国白蛾发生数据（可能是另一份源数据）

### 2. 地理边界数据
- **`./datas/shandong_pest_data/shandong.json`** ⭐ **重要源文件**
  - 内容：山东省各县边界GeoJSON数据
  - 格式：MultiPolygon几何体
  - 包含字段：adcode, name, center, centroid, geometry

### 3. 气象栅格数据
- **`./data/historical_features/*.tif`** ⭐ **重要源文件**
  - 内容：历史气象栅格数据
  - 时间：2022-2023年（部分月份）
  - 特征类型：
    - avg_tmp：平均温度
    - precipitation：降雨量
    - rel_humidity：相对湿度
    - ndvi：植被指数
    - soil_moisture：土壤湿度
    - dem：高程

## 🔄 中间生成文件

### 1. 发病数据处理结果
- **`./datas/shandong_pest_data/shandong_american_moth_processed.csv`**
  - 来源：从`发病情况.xlsx`处理生成
  - 内容：标准化的发病数据
  - 字段：County, Year, Month, Severity, Period

- **`./datas/shandong_pest_data/shandong_fall_webworm_occurrences_20250926_221822.csv`**
  - 来源：早期生成的发病数据

### 2. 气象数据处理结果
- **`./datas/shandong_pest_data/shandong_spatial_meteorological_data.csv`** ⭐ **核心数据**
  - 来源：基于GeoJSON边界从栅格气象数据提取
  - 内容：日度气象数据
  - 样本数：217,294条记录
  - 字段：county_name, year, month, day, latitude, longitude, Temperature, Humidity, Rainfall, WS, WD, Pressure, Sunshine, Visibility等

## 🎯 最终训练数据集

### 1. 基于正确发病程度理解的最终数据 ⭐ **推荐使用**
- **`./datas/shandong_pest_data/real_occurrence_train.csv`**
  - 样本数：4,041条（2019-2021年）
  - 特征数：31个气象特征
  - 发病程度：1=低度发生, 2=中度发生, 3=高度发生

- **`./datas/shandong_pest_data/real_occurrence_val.csv`**
  - 样本数：1,347条（2022年）

- **`./datas/shandong_pest_data/real_occurrence_test.csv`**
  - 样本数：1,347条（2023年）

- **`./datas/shandong_pest_data/real_occurrence_complete_data.csv`**
  - 样本数：6,735条（完整数据）

- **`./datas/shandong_pest_data/real_occurrence_scaler.joblib`**
  - 特征标准化器

- **`./datas/shandong_pest_data/real_occurrence_statistics.json`**
  - 数据统计信息

### 2. 早期生成的其他数据集（可能不正确）
- **`./datas/shandong_pest_data/american_moth_train.csv`** 等
- **`./datas/shandong_pest_data/real_meteo_train.csv`** 等
- **`./datas/shandong_pest_data/final_merged_train.csv`** 等
- **`./datas/shandong_pest_data/spatial_train.csv`** 等

## 📊 数据统计摘要

### 真实发病程度分布（正确理解）
- **程度1（低度发生）**: 87.5%
- **程度2（中度发生）**: 11.4%
- **程度3（高度发生）**: 1.2%

### 数据覆盖范围
- **县区数量**: 112个县区
- **时间跨度**: 2019-2023年（5年）
- **气象特征**: 31个（包括基础气象要素和工程特征）
- **样本总数**: 6,735条月度记录

## 🚀 使用建议

### 直接用于模型训练的文件：
1. **`real_occurrence_train.csv`** - 训练集
2. **`real_occurrence_val.csv`** - 验证集
3. **`real_occurrence_test.csv`** - 测试集
4. **`real_occurrence_scaler.joblib`** - 特征标准化器

### 源文件（如需重新处理）：
1. **`发病情况.xlsx`** - 真实发病数据源
2. **`shandong.json`** - 县边界数据源
3. **`./data/historical_features/*.tif`** - 气象栅格数据源

## ⚠️ 重要说明

1. **发病程度含义**：所有县都有美国白蛾发生，程度1-3表示严重程度，不是是否发生
2. **数据质量**：最终推荐使用`real_occurrence_*`系列文件，这些基于正确理解重新生成
3. **时间范围**：气象数据只覆盖2022-2023年，但通过工程方法扩展到2019-2023年
4. **特征工程**：包含季节特征、滞后特征、美国白蛾活动水平等专业特征

## 📝 生成脚本

- **`remerge_with_real_occurrence.py`** - 生成最终推荐数据集的脚本
- **`merge_meteo_occurrence.py`** - 早期合并脚本
- **`real_meteo_integrator.py`** - 气象数据整合脚本