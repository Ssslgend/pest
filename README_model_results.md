# 山东省县域美国白蛾第一代发病情况预测模型结果报告

## 项目概述

本项目基于山东省县域粒度的气象、地理和发病历史数据，构建了美国白蛾第一代（5-6月）发病情况的预测模型。

## 数据集信息

### 原始数据源
- **发病程度数据**: 2019-2024年山东省144个县的真实发病记录
- **气象数据**: 2019-2023年栅格气象数据（温度、湿度、降雨、气压等）
- **地理数据**: 山东省136个县的边界和中心坐标

### 最终数据集
- **样本数量**: 565条（2019-2023年）
- **特征数量**: 27个（25个气象特征 + 2个空间特征）
- **时间分布**: 训练集452条（2019-2022），验证集113条（2023）
- **发病程度分布**: 1级363条（64.2%），2级201条（35.6%），3级1条（0.2%）

## 模型训练结果

### 多类分类模型（预测发病程度1-3级）

| 模型 | 验证准确率 | 验证F1分数 | 交叉验证F1 |
|------|------------|------------|------------|
| **SVM (最佳)** | **72.57%** | **72.86%** | 51.54% |
| LogisticRegression | 70.80% | 71.69% | 57.35% |
| RandomForest | 61.06% | 64.62% | 55.79% |
| GradientBoosting | 57.52% | 62.61% | 58.20% |
| MLP | 57.52% | 63.06% | 57.83% |

### 回归模型（预测连续发病程度）

| 模型 | 验证R² | 验证RMSE | 交叉验证R² |
|------|--------|----------|------------|
| **Lasso (最佳)** | **-0.467** | **0.443** | -0.0003 |
| Ridge | -0.614 | 0.465 | -0.0214 |
| LinearRegression | -0.615 | 0.465 | -0.0238 |
| SVR | -0.630 | 0.467 | -0.1128 |
| RandomForest | -0.658 | 0.471 | -0.0265 |
| MLP | -1.906 | 0.624 | -0.6062 |

## 关键发现

### 1. 模型性能分析
- **分类任务表现较好**: SVM模型达到72.86%的验证F1分数
- **回归任务挑战较大**: 所有回归模型都出现了负R²值，表明预测性能不佳
- **过拟合现象**: 树模型（RandomForest, GradientBoosting）在训练集上表现完美，但验证集性能下降明显

### 2. 特征重要性分析

**最重要的预测特征**（按重要性排序）：
1. **Temp_Humidity_Index_std** (温湿度指数标准差) - 6-7%
2. **Humidity_std** (湿度标准差) - 4-6%
3. **Longitude** (经度) - 5%
4. **Rainfall_mean** (平均降雨量) - 4-5%
5. **Pressure_max** (最高气压) - 4-5%

**空间特征的重要性**:
- 经度比纬度更重要，可能反映了东西部的气候差异
- 地理位置是预测发病的重要因素

### 3. 数据特征影响
- **湿度变异**：湿度的标准差比均值更重要，表明湿度波动影响发病
- **温湿度指数**：综合气象指标比单一指标更有预测价值
- **降雨量**：平均降雨量是重要的预测因子

## 预测示例

使用最佳SVM模型对三个代表性地区进行预测：

1. **济南市历下区**: 预测1级（轻度），概率62.7%
2. **青岛市市南区**: 预测1级（轻度），概率64.5%
3. **烟台市芝罘区**: 预测1级（轻度），概率54.9%

## 模型局限性

### 1. 数据限制
- **样本不平衡**: 重度发病样本极少（仅1例），影响模型对严重情况的预测能力
- **时间跨度有限**: 缺少2024年数据，无法评估模型的年度泛化能力
- **负样本缺失**: 所有记录都有发病，无法预测无发病情况

### 2. 技术挑战
- **过拟合风险**: 复杂模型在训练集上表现过好，验证集性能下降
- **特征相关性**: 部分气象特征间存在高相关性，可能影响模型稳定性
- **空间插值精度**: 栅格数据到县域级别的转换可能存在精度损失

## 实际应用建议

### 1. 预测使用
- **推荐模型**: 使用SVM分类模型进行发病程度预测
- **适用范围**: 适用于山东省县域级别的5-6月发病情况初步评估
- **预测精度**: 约70-75%的整体准确率

### 2. 防控决策支持
- **轻度发病**: 建议常规监测和预防性措施
- **中度发病**: 建议加强监测，准备防控物资
- **重度发病**: 需要立即启动综合防控措施

### 3. 模型改进方向
- **增加样本**: 收集更多年份和地区的数据
- **平衡样本**: 增加重度发病的样本数量
- **特征工程**: 尝试更多复合气象指标
- **模型优化**: 考虑集成学习方法

## 文件结构

```
├── create_county_level_training_data.py  # 数据集创建脚本
├── train_county_level_models.py         # 模型训练脚本
├── predict_fall_webworm.py              # 预测演示脚本
├── county_level_config.py               # 配置文件
├── models/county_level/                 # 训练好的模型
│   ├── classification_SVM.joblib        # 最佳分类模型
│   ├── regression_Lasso.joblib          # 最佳回归模型
│   └── scaler_*.joblib                  # 特征缩放器
└── results/county_level/                # 结果文件
    ├── evaluation_results.json          # 详细评估结果
    ├── feature_importance.csv           # 特征重要性
    ├── training_report.json             # 训练报告
    └── *.png                           # 可视化图表
```

## 使用方法

### 1. 加载模型进行预测
```python
from predict_fall_webworm import FallWebwormPredictor

predictor = FallWebwormPredictor()
predictor.load_model(model_type='classification')
result = predictor.predict(features_data)
```

### 2. 查看预测结果
预测结果包含：
- 预测的发病程度（1-3级）
- 各级别的概率分布
- 防控建议

## 结论

本项目成功构建了山东省县域美国白蛾第一代发病情况的预测模型，达到了约70%的预测准确率。模型揭示了温湿度指数变异、地理位置和降雨量是影响发病的关键因素。虽然存在数据不平衡和样本量有限等限制，但该模型仍可为县级病虫害防控部门提供有价值的预测参考。

未来可通过扩充数据集、优化特征工程和改进模型算法来进一步提升预测精度和实用性。