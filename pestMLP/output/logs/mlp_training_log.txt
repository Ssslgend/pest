2025-05-01 16:51:08,233 - INFO - Using device: cuda
2025-05-01 16:51:08,233 - INFO - Random seed set to: 42
2025-05-01 16:51:08,233 - INFO - --- Starting MLP Model Training ---
2025-05-01 16:51:08,234 - INFO - Attempting to load data from path in config: e:\code\0424\pestBIstm\pestBIstm\datas\sd_all_2.csv
2025-05-01 16:51:08,234 - INFO - Loading data from: e:\code\0424\pestBIstm\pestBIstm\datas\sd_all_2.csv
2025-05-01 16:51:08,236 - INFO - Successfully loaded CSV with encoding: utf-8
2025-05-01 16:51:08,236 - INFO - Data loaded successfully with shape: (123, 30)
2025-05-01 16:51:08,236 - INFO - Columns: ['sd_station', 'X', 'Y', '等温性', '降水季节性', '年降水量', '年均温_', '平均日较差', '温度季节性', '温度年较差', '最干季度降水量', '最干季度平均温度', '最干月降水量', '最冷季度降水量', '最冷季度平均温度', '最冷月最低温', '最热季度降水量', '最热季度平均温度', '最热月最高温', '最湿季度降水量', '最湿季度平均温度', 'Unnamed: 21', 'Unnamed: 22', 'Unnamed: 23', 'evi_Band_1', 'lai_Band_1', 'lst_Band_1', 'ndvi_Band_', 'pet_Band_1', 'BYQ_baie']
2025-05-01 16:51:08,237 - INFO - Target column: BYQ_baie
2025-05-01 16:51:08,238 - INFO - Coordinate columns: ['X', 'Y']
2025-05-01 16:51:08,238 - INFO - Identified feature columns (26): ['等温性', '降水季节性', '年降水量', '年均温_', '平均日较差', '温度季节性', '温度年较差', '最干季度降水量', '最干季度平均温度', '最干月降水量', '最冷季度降水量', '最冷季度平均温度', '最冷月最低温', '最热季度降水量', '最热季度平均温度', '最热月最高温', '最湿季度降水量', '最湿季度平均温度', 'Unnamed: 21', 'Unnamed: 22', 'Unnamed: 23', 'evi_Band_1', 'lai_Band_1', 'lst_Band_1', 'ndvi_Band_', 'pet_Band_1']
2025-05-01 16:51:08,239 - WARNING - Found 369 NaN values in features. Imputing with mean.
2025-05-01 16:51:08,241 - INFO - Unique values in target column 'BYQ_baie': {0.0: 82, 1.0: 41}
2025-05-01 16:51:08,241 - INFO - Data shapes - X: (123, 23), y: (123,), Coords: (123, 2)
2025-05-01 16:51:08,241 - INFO - Features scaled using StandardScaler.
2025-05-01 16:51:08,244 - INFO - Scaler saved to e:\code\0424\pestBIstm\pestBIstm\pestMLP\output\scalers\mlp_scaler.joblib
2025-05-01 16:51:08,245 - INFO - Data ready for MLP: X shape (123, 23), y shape (123, 1)
2025-05-01 16:51:08,245 - INFO - Total dataset size: 123
2025-05-01 16:51:08,246 - INFO - Training set size: 105
2025-05-01 16:51:08,246 - INFO - Validation set size: 18
2025-05-01 16:51:08,345 - INFO - MLP Model initialized with input_size=23:
MLPModel(
  (network): Sequential(
    (0): Linear(in_features=23, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=64, bias=True)
    (4): ReLU()
    (5): Dropout(p=0.3, inplace=False)
    (6): Linear(in_features=64, out_features=32, bias=True)
    (7): ReLU()
    (8): Dropout(p=0.3, inplace=False)
    (9): Linear(in_features=32, out_features=1, bias=True)
  )
  (output_activation): Sigmoid()
)
2025-05-01 16:51:08,345 - INFO - Total parameters: 13441
2025-05-01 16:51:08,346 - INFO - Using loss function: BCELoss
2025-05-01 16:51:08,946 - INFO - Using optimizer: AdamW with LR: 0.001
2025-05-01 16:51:08,946 - INFO - Using StepLR scheduler: step_size=20, gamma=0.5
2025-05-01 16:51:08,946 - INFO - --- Starting Training Loop ---
2025-05-01 16:51:09,047 - INFO - Epoch 1/100 - Dur: 0.10s - Train Loss: 0.7222, Train AUC: 0.4867 - Val Loss: 0.7011, Val AUC: 0.3636
2025-05-01 16:51:09,048 - INFO - Val AUC improved (-inf --> 0.3636).
2025-05-01 16:51:09,048 - INFO - Saving best model to e:\code\0424\pestBIstm\pestBIstm\pestMLP\output\checkpoints\mlp_model_best.pth
2025-05-01 16:51:09,058 - INFO - Epoch 2/100 - Dur: 0.01s - Train Loss: 0.6705, Train AUC: 0.5940 - Val Loss: 0.6803, Val AUC: 0.5195
2025-05-01 16:51:09,058 - INFO - Val AUC improved (0.3636 --> 0.5195).
2025-05-01 16:51:09,058 - INFO - Saving best model to e:\code\0424\pestBIstm\pestBIstm\pestMLP\output\checkpoints\mlp_model_best.pth
2025-05-01 16:51:09,068 - INFO - Epoch 3/100 - Dur: 0.01s - Train Loss: 0.6603, Train AUC: 0.5290 - Val Loss: 0.6628, Val AUC: 0.6104
2025-05-01 16:51:09,068 - INFO - Val AUC improved (0.5195 --> 0.6104).
2025-05-01 16:51:09,068 - INFO - Saving best model to e:\code\0424\pestBIstm\pestBIstm\pestMLP\output\checkpoints\mlp_model_best.pth
2025-05-01 16:51:09,077 - INFO - Epoch 4/100 - Dur: 0.01s - Train Loss: 0.6356, Train AUC: 0.6379 - Val Loss: 0.6483, Val AUC: 0.6234
2025-05-01 16:51:09,077 - INFO - Val AUC improved (0.6104 --> 0.6234).
2025-05-01 16:51:09,077 - INFO - Saving best model to e:\code\0424\pestBIstm\pestBIstm\pestMLP\output\checkpoints\mlp_model_best.pth
2025-05-01 16:51:09,085 - INFO - Epoch 5/100 - Dur: 0.01s - Train Loss: 0.5876, Train AUC: 0.7138 - Val Loss: 0.6356, Val AUC: 0.6364
2025-05-01 16:51:09,086 - INFO - Val AUC improved (0.6234 --> 0.6364).
2025-05-01 16:51:09,086 - INFO - Saving best model to e:\code\0424\pestBIstm\pestBIstm\pestMLP\output\checkpoints\mlp_model_best.pth
2025-05-01 16:51:09,095 - INFO - Epoch 6/100 - Dur: 0.01s - Train Loss: 0.6096, Train AUC: 0.6429 - Val Loss: 0.6247, Val AUC: 0.6623
2025-05-01 16:51:09,096 - INFO - Val AUC improved (0.6364 --> 0.6623).
2025-05-01 16:51:09,096 - INFO - Saving best model to e:\code\0424\pestBIstm\pestBIstm\pestMLP\output\checkpoints\mlp_model_best.pth
2025-05-01 16:51:09,105 - INFO - Epoch 7/100 - Dur: 0.01s - Train Loss: 0.5856, Train AUC: 0.7084 - Val Loss: 0.6168, Val AUC: 0.6883
2025-05-01 16:51:09,105 - INFO - Val AUC improved (0.6623 --> 0.6883).
2025-05-01 16:51:09,105 - INFO - Saving best model to e:\code\0424\pestBIstm\pestBIstm\pestMLP\output\checkpoints\mlp_model_best.pth
2025-05-01 16:51:09,115 - INFO - Epoch 8/100 - Dur: 0.01s - Train Loss: 0.6096, Train AUC: 0.6549 - Val Loss: 0.6098, Val AUC: 0.6883
2025-05-01 16:51:09,115 - INFO - Val AUC did not improve for 1 epochs.
2025-05-01 16:51:09,122 - INFO - Epoch 9/100 - Dur: 0.01s - Train Loss: 0.6175, Train AUC: 0.6301 - Val Loss: 0.6036, Val AUC: 0.7013
2025-05-01 16:51:09,122 - INFO - Val AUC improved (0.6883 --> 0.7013).
2025-05-01 16:51:09,123 - INFO - Saving best model to e:\code\0424\pestBIstm\pestBIstm\pestMLP\output\checkpoints\mlp_model_best.pth
2025-05-01 16:51:09,132 - INFO - Epoch 10/100 - Dur: 0.01s - Train Loss: 0.6047, Train AUC: 0.6599 - Val Loss: 0.5985, Val AUC: 0.7143
2025-05-01 16:51:09,132 - INFO - Val AUC improved (0.7013 --> 0.7143).
2025-05-01 16:51:09,132 - INFO - Saving best model to e:\code\0424\pestBIstm\pestBIstm\pestMLP\output\checkpoints\mlp_model_best.pth
2025-05-01 16:51:09,141 - INFO - Epoch 11/100 - Dur: 0.01s - Train Loss: 0.5465, Train AUC: 0.7722 - Val Loss: 0.5943, Val AUC: 0.7143
2025-05-01 16:51:09,141 - INFO - Val AUC did not improve for 1 epochs.
2025-05-01 16:51:09,147 - INFO - Epoch 12/100 - Dur: 0.01s - Train Loss: 0.5570, Train AUC: 0.7349 - Val Loss: 0.5900, Val AUC: 0.7273
2025-05-01 16:51:09,147 - INFO - Val AUC improved (0.7143 --> 0.7273).
2025-05-01 16:51:09,147 - INFO - Saving best model to e:\code\0424\pestBIstm\pestBIstm\pestMLP\output\checkpoints\mlp_model_best.pth
2025-05-01 16:51:09,157 - INFO - Epoch 13/100 - Dur: 0.01s - Train Loss: 0.5565, Train AUC: 0.7390 - Val Loss: 0.5868, Val AUC: 0.7403
2025-05-01 16:51:09,158 - INFO - Val AUC improved (0.7273 --> 0.7403).
2025-05-01 16:51:09,158 - INFO - Saving best model to e:\code\0424\pestBIstm\pestBIstm\pestMLP\output\checkpoints\mlp_model_best.pth
2025-05-01 16:51:09,166 - INFO - Epoch 14/100 - Dur: 0.01s - Train Loss: 0.5545, Train AUC: 0.7191 - Val Loss: 0.5835, Val AUC: 0.7403
2025-05-01 16:51:09,167 - INFO - Val AUC did not improve for 1 epochs.
2025-05-01 16:51:09,174 - INFO - Epoch 15/100 - Dur: 0.01s - Train Loss: 0.5450, Train AUC: 0.7461 - Val Loss: 0.5803, Val AUC: 0.7532
2025-05-01 16:51:09,175 - INFO - Val AUC improved (0.7403 --> 0.7532).
2025-05-01 16:51:09,175 - INFO - Saving best model to e:\code\0424\pestBIstm\pestBIstm\pestMLP\output\checkpoints\mlp_model_best.pth
2025-05-01 16:51:09,184 - INFO - Epoch 16/100 - Dur: 0.01s - Train Loss: 0.5447, Train AUC: 0.7419 - Val Loss: 0.5778, Val AUC: 0.7532
2025-05-01 16:51:09,184 - INFO - Val AUC did not improve for 1 epochs.
2025-05-01 16:51:09,190 - INFO - Epoch 17/100 - Dur: 0.01s - Train Loss: 0.5257, Train AUC: 0.7746 - Val Loss: 0.5756, Val AUC: 0.7532
2025-05-01 16:51:09,191 - INFO - Val AUC did not improve for 2 epochs.
2025-05-01 16:51:09,197 - INFO - Epoch 18/100 - Dur: 0.01s - Train Loss: 0.5490, Train AUC: 0.7345 - Val Loss: 0.5734, Val AUC: 0.7532
2025-05-01 16:51:09,197 - INFO - Val AUC did not improve for 3 epochs.
2025-05-01 16:51:09,204 - INFO - Epoch 19/100 - Dur: 0.01s - Train Loss: 0.4823, Train AUC: 0.8422 - Val Loss: 0.5706, Val AUC: 0.7532
2025-05-01 16:51:09,204 - INFO - Val AUC did not improve for 4 epochs.
2025-05-01 16:51:09,210 - INFO - Epoch 20/100 - Dur: 0.01s - Train Loss: 0.5223, Train AUC: 0.7713 - Val Loss: 0.5679, Val AUC: 0.7532
2025-05-01 16:51:09,211 - INFO - Val AUC did not improve for 5 epochs.
2025-05-01 16:51:09,217 - INFO - Epoch 21/100 - Dur: 0.01s - Train Loss: 0.5038, Train AUC: 0.7954 - Val Loss: 0.5666, Val AUC: 0.7532
2025-05-01 16:51:09,217 - INFO - Val AUC did not improve for 6 epochs.
2025-05-01 16:51:09,223 - INFO - Epoch 22/100 - Dur: 0.01s - Train Loss: 0.4995, Train AUC: 0.8186 - Val Loss: 0.5655, Val AUC: 0.7532
2025-05-01 16:51:09,224 - INFO - Val AUC did not improve for 7 epochs.
2025-05-01 16:51:09,230 - INFO - Epoch 23/100 - Dur: 0.01s - Train Loss: 0.5159, Train AUC: 0.7883 - Val Loss: 0.5641, Val AUC: 0.7532
2025-05-01 16:51:09,230 - INFO - Val AUC did not improve for 8 epochs.
2025-05-01 16:51:09,236 - INFO - Epoch 24/100 - Dur: 0.01s - Train Loss: 0.4976, Train AUC: 0.8032 - Val Loss: 0.5626, Val AUC: 0.7532
2025-05-01 16:51:09,237 - INFO - Val AUC did not improve for 9 epochs.
2025-05-01 16:51:09,242 - INFO - Epoch 25/100 - Dur: 0.01s - Train Loss: 0.5092, Train AUC: 0.8049 - Val Loss: 0.5613, Val AUC: 0.7532
2025-05-01 16:51:09,242 - INFO - Val AUC did not improve for 10 epochs.
2025-05-01 16:51:09,248 - INFO - Epoch 26/100 - Dur: 0.01s - Train Loss: 0.4686, Train AUC: 0.8355 - Val Loss: 0.5598, Val AUC: 0.7532
2025-05-01 16:51:09,249 - INFO - Val AUC did not improve for 11 epochs.
2025-05-01 16:51:09,255 - INFO - Epoch 27/100 - Dur: 0.01s - Train Loss: 0.4863, Train AUC: 0.8231 - Val Loss: 0.5586, Val AUC: 0.7532
2025-05-01 16:51:09,255 - INFO - Val AUC did not improve for 12 epochs.
2025-05-01 16:51:09,262 - INFO - Epoch 28/100 - Dur: 0.01s - Train Loss: 0.4976, Train AUC: 0.7991 - Val Loss: 0.5575, Val AUC: 0.7532
2025-05-01 16:51:09,262 - INFO - Val AUC did not improve for 13 epochs.
2025-05-01 16:51:09,268 - INFO - Epoch 29/100 - Dur: 0.01s - Train Loss: 0.5011, Train AUC: 0.7995 - Val Loss: 0.5565, Val AUC: 0.7532
2025-05-01 16:51:09,269 - INFO - Val AUC did not improve for 14 epochs.
2025-05-01 16:51:09,275 - INFO - Epoch 30/100 - Dur: 0.01s - Train Loss: 0.4993, Train AUC: 0.8007 - Val Loss: 0.5558, Val AUC: 0.7532
2025-05-01 16:51:09,275 - INFO - Val AUC did not improve for 15 epochs.
2025-05-01 16:51:09,275 - INFO - Early stopping triggered after 30 epochs.
2025-05-01 16:51:09,275 - INFO - --- Training Finished --- Total Time: 1.04s
2025-05-01 16:51:09,588 - INFO - --- Evaluating Best Model on Validation Set ---
2025-05-01 16:51:09,596 - INFO - Loaded best model from epoch 15 with Val AUC 0.7532
2025-05-01 16:51:09,601 - INFO - Best Model Validation Set Metrics:
2025-05-01 16:51:09,601 - INFO -   loss: 0.5803
2025-05-01 16:51:09,601 - INFO -   auc: 0.7532
2025-05-01 16:51:09,601 - INFO -   accuracy: 0.7222
2025-05-01 16:51:09,601 - INFO -   precision: 0.7500
2025-05-01 16:51:09,601 - INFO -   recall: 0.4286
2025-05-01 16:51:09,601 - INFO -   f1: 0.5455
2025-05-01 16:51:09,602 - INFO -   confusion_matrix: 
[[10  1]
 [ 4  3]]
